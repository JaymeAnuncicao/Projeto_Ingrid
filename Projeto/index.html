<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <title>Teste Range</title>
  <!-- Link Bootstrap -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <link rel="stylesheet" href="css/Style.css">
</head>

<body>
  <!-- SEÇÃO DO RANGER -->
  <section id="ranger">
    <div class="simulador container">
      <p class="text-size">SIMULE SUA <b class="text-dis">ECONOMIA</b></p>
      <hr noshade class="line">
      <div class="row mt-5">
        <div class="col-md-8 mt-2">

          <p class="text-size-sub"><b>Gasto médio mensal com energia:</b></p>
          <input type="range" title="Header" data-toggle="popover" data-trigger="hover" data-content="Some content"
            class="slider" id="percent" name="rangeInput" oninput=" mostrarCalculo(this.value), mostrarPorcentagem(this.value)" min="25" max="10000"
            value="25" onchange="updateTextInput(this.value);">
          <p class="text-size-sub-01">Valor médio de sua conta de luz: R$ <span id="exibePercent">0</span></p>
          <div class="container">
            <div class="input-group col-md-6">
              <div class="input-group-text">Valor: R$</div>
              <input type="text" maxlength="9" id="textInput" class="dinheiro form-control"
                onchange="mostrarPorcentagem(this.value), mostrarCalculo(this.value)" onkeypress="mascara(this,mreais)">
            </div>
            <div class="row pt-5 mt-5 row-mode">
              <div class="row justify-content-center">
                <div class="col-md-4 mr-5">
                  <h5 class="arco">
                    <p class="porcent">Até<br>90%</p>
                  </h5>
                  <h6 class="h6-mode">ECONOMICO</h6>
                </div>
              </div>
              <div class="col-md-5 ml-5">
                <p class="text-size-sub-01">Em 25 anos, seu sistema será capaz de gerar uma economia de:</p>
                <p class="text-dis text-size">R$ <span id="calculo">0,00</span> </p>
              </div>
            </div>
          </div>
        </div>
        <div class="col-4 ">
          <div class="row justify-content-center">
            <p class="text-size-sub02">Economia é para todos inclusive você!</p>
          </div>

          <img src="images/fotovoltaica.jpeg" class="parallax" alt="FOTOVOLTAICA" width="400">
        </div>
      </div>
    </div>
  </section>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://igorescobar.github.io/jQuery-Mask-Plugin/js/jquery.mask.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>

  <script>
    // Exibe o valor do Range ao lado
    function mostrarPorcentagem(novoValor) {
      document.getElementById("exibePercent").innerHTML = novoValor.replace('.', ',');
    }

    //Exibe a porcentagem de 90%
    function mostrarCalculo(calc) {
      document.getElementById("calculo").innerHTML = (parseFloat(calc*270).toFixed(2)).replace('.', ',');    
      console.log(calc)
    }

    // Mexer no Range muda o input
    function updateTextInput(val) {
      document.getElementById('textInput').value = val + ",00";
    }


    // Máscara do Input
    function mascara(o, f) {
      v_obj = o
      v_fun = f
      setTimeout("execmascara()", 1);
    }

    function execmascara() {
      v_obj.value = v_fun(v_obj.value)
    }

    function mreais(v) {
      v = v.replace(/\D/g, "") //Remove tudo o que não é dígito
      v = v.replace(/(\d{2})$/, ".$1") //Coloca o ponto
      if(v.length >= 8){
        return '10000.00';
      }
      return v;
    }

    $(document).ready(function () {
      $('[data-toggle="popover"]').popover();
    }); 
  </script>
  
</body>

</html>